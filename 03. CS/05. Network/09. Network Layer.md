## 3계층 - 네트워크 계층(Network Layer)
### 1. 라우팅과 포워딩-> 라우터에서 실행된다.
1. 라우팅(제어 평면, S/W): 송신자가 수신자에게 패킷을 전송할 때, 어떤 라우팅 경로를 통해 전송할것인지를 결정하는 것
2. 포워딩(데이터 평면, H/W): 패킷이 라우터의 입력링크에 도착했을 때, 그 패킷을 적절한 출력링크로 이동시키는 것

### 2. 네트워크 계층
1. 전송 호스트에서 수신 호스트로의 전송 세그먼트(데이터) 전송
2. 전송 호스트에서 세그먼트를 데이터그램으로 캡슐화하여 전송
3. 수신 호스트에서는 데이터그램을 전송 계층으로 전달
4. 모든 호스트와 라우터에는 네트워크 계층 프로토콜이 있다. 
5. 라우터는 자신을 통과하는 모든 IP 데이터그램의 헤더 필드를 검사한다. 헤더필드에는 포트번호가 포함되어 있어 이 포트번호를 통해 전송 계층으로 올린다.

### 3.  네트워크 서비스 모델
+ 네트워크 계층에선 시간 보장(bandwidth), 손실, 순서등을 보장하지 않는다.

``` -> best effort: 최선을 다할뿐 신뢰성을 보장하지는 못한다. ```


### 4. 데이터 그램 네트워크: 패킷 교환 방식으로 동작하면서 IP주소를 사용하는 네트워크 서비스 모델
1. 연결 지향적이지 않은(connectionless) 서비스 제공. 즉, 각 패킷은 서로 독립적이며 개별적으로 처리.
+ 패킷 단위로 라우팅하기 때문에 똑같은 헤더라도 다른 경로로 보내질 수 있다.  
2. 패킷은 출발지에서 목적지로 독립적으로 전달되며, 전송 시에 라우터에서 최적의 경로를 찾아 전송된다.


### 5. Longest Prefix Matching
가장 오랫동안 매핑되는 엔트리로 패킷을 전달하는 것


### 6. 라우터 구조
+ 입력 포트 -> switching fabric -> 출력 포트
1. 입력 포트
+ 포워딩 테이블 포함 -> 검색 기능
+ 입력 포트 딜레이 : 입력 포트의 처리 속도를 합친 것보다 패브릭의 속도가 더 느린 경우, 입력 큐에서 대기열이 발생하여 입력 버퍼 오버플로로 인한 대기 지연과 패킷 손실이 발생할 수 있다. 이러한 상황에서 대기열 맨 앞에 있는 패킷이 처리되지 않으면, 이 패킷이 다른 패킷들의 전달을 막게 되는데, 이를 Head-of-the-Line (HOL) 블로킹이라고 한다.
2. switching fabric 
+ 버스를 통한 교환<br />
: 동시에 여러 패킷이 다른 입력 포트에 있는 라우터에 도착하면, 한번에 하나만 버스를 통과할 수 있기 때문에 하나를 제외한 모든 패킷이 대기해야 함 -> 버스 속도에 의해 제어된다.
+ 상호 연결 네트워크를 통한 교환<br />
		: 스위치를 격자로 두고, true인 애들로만 이동
3. 출력 포트
+ 출력 포트의 메모리에 저장된 패킷을 가져와 출력 링크를 통해 전송한다
+ 데이터 그램은 큐 버퍼에서 손실, 지연될 수 있다.
    + 출력 포트 큐잉 딜레이: 같은 출력 포트로 향할 때
+ 우선 순위 스케쥴링을 통해 급한 패킷을 먼저 보낼 수 있다.

### 7. IP : Internet Protocol
+ IP datagram format
    + Version (4 bits): IP datagram의 버전. IPv4와 IPv6
    + Header Length (4 bits): IP 헤더의 길이를 32비트 단위로 표시. IP 헤더 내부에 있는 다른 필드들의 위치를 결정
    + Type of Service (8 bits): IP 패킷의 우선순위와 서비스 품질. 트래픽을 다른 클래스로 분류하여 특정 서비스 수준을 보장하는 데 사용
    + Total Length (16 bits): IP datagram의 전체 길이. 헤더와 데이터의 길이를 합한 값
    + Identification (16 bits): IP 패킷의 고유 식별자. 패킷의 조각화와 재조립을 위해 사용
    + Flags (3 bits): IP datagram의 조각화와 관련된 정보를 제공
    + Fragment Offset (13 bits): IP datagram의 조각화된 조각의 상대적인 오프셋
    + Time to Live (8 bits): IP datagram이 네트워크에서 살아 있는 시간. 라우터를 통과할 때마다 1씩 감소합니다. 값이 0이 되면 패킷은 삭제
    + Protocol (8 bits): 상위 계층 프로토콜의 종류. TCP, UDP, ICMP 등의 값
    + Header Checksum (16 bits): IP 헤더의 오류 검사를 위한 체크섬 값
    + Source IP Address (32 bits): IP datagram의 출발지 IP 주소
    + Destination IP Address (32 bits): IP datagram의 목적지 IP 주소
    + Options (가변 길이): IP datagram에 추가 정보를 제공하는 선택적인 필드
    + data: IP datagram의 마지막 필드는 데이터 필드. 상위 계층 프로토콜에 의해 생성된 변수 길이의 데이터 세그먼트를 포함. IP는 라우팅을 위한 프로토콜이기 때문에, IP datagram 자체는 데이터의 신뢰성이나 무결성을 보장하지 않지만 TCP나 UDP와 같은 상위 계층 프로토콜이 이를 담당하며, 데이터 세그먼트를 분할하거나 재조립하여 신뢰성과 무결성을 보장한다. 따라서 IP datagram의 데이터 필드는 일반적으로 TCP나 UDP 세그먼트이며, 이것들은 데이터의 전송 및 수신을 관리하기 위한 매우 중요한 역할을 한다.
