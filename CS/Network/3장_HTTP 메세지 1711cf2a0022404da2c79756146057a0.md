# 3장_HTTP 메세지

## 개요

- 메세지가 어떻게 흘러가는가
- HTTP 메세지의 세 부분(시작줄, 헤더, 개체 본문)
- 요청과 응답 메세지의 차이
- 요청 메세지가 지원하는 여러 기능(메서드)들
- 응답 메세지가 반환하는 여러 상태 코드들
- 여러 HTTP 헤더들은 무슨 일을 하는가?

## 3-1. 메세지의 흐름

- HTTP 메세지는 HTTP 애플리케이션 간에 주고 받은 데이터의 블록들이다. 이 데이터의 블록들은 메세지의 내용과 의미를 설명하는 텍스트 메타 정보로 시작하고 그 다음에 선택적으로 데이터가 올 수 있다. 이 메세지는 클라이언트, 서버, 프락시 사이를 흐른다.
- ‘인바운드’, ‘아웃바운드’, ‘업스트림’, ‘다운스트림’ 은 메세지의 방향을 의미하는 용어이다.
- 메세지는 원 서버 방향을 인바운드로 하여 송신된다.
    - 클라이언트 → 프락시1 → 프락시2 → 프락시3 → 서버
        - 인바운드 : 서버 방향 → 메세지가 원 서버로 향하는 것
        - 아웃바운드 : 클라이언트 방향
            
            → 모든 처리가 끝난 뒤에 메세지가 사용자 에이전트로 돌아오는 것
            
- 다운스트림으로 흐르는 메세지
    - 요청/응답 상관 없이 모든 메세지는 다운스트림으로 흐른다.
    - 메세지는 결코 업스트림으로 흐르지 않는다.
- HTTP 메세지 구성
    - 시작줄 : 어떤 메세지 인지 설명
    - 헤더 : 속성
    - 본문 : 선택적인 데이터
- 요청메세지(서버에 대한 요구)와 응답메세지(그에 따른 결과)
    - 요청메세지 : HTTP 요청 메세지는 명령과 URL을 포함한다
        - <메서드> <요청URL> <버전: 사용중인 HTTP 버전>
        - <헤더>
        - <엔터티 본문 : 임의의 데이터 블록 포함>’
    - 응답메세지
        - <버전> <상태코드: 결과를 나타내는 3자리 숫자> <사유구절 : 상태코드 설명문구>
        - <헤더>
        - <엔터티 본문 : 임의의 데이터 블록 포함>
- 메서드
    - 메서드는 요청메세지에 시작줄에 들어가며, 서버에게 무엇을 해야하는지 말한다.
    
    | 메서드 | 설명 | 메세지 본문 여부 |
    | --- | --- | --- |
    | GET | 서버에 리소스 요청
    → 서버에서 문서를 가져오는 것 | X |
    | HEAD | 서버에서 어떤 문서에 대해 헤더만 요청 | X |
    | POST | 서버가 처리해야 할 데이터 보냄
    →서버에 입력데이터를 전송하기 위해 설계됨
    →서버가 처리해줬으면 하는 데이터를 보내는 것 | O |
    | PUT | 서버에 요청 메세지의 본문 저장
    →서버에 문서를 수정하거나, 새로 만들 때 사용 | O |
    | TRACE | 메세지가 프락시를 거쳐 서버에 도달하는 과정 추적
    →클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이는지  | X |
    | OPTIONS | 서버가 어떤 메서드를 수행할 수 있는지 확인
    →응답 메세지에서 Allow를 통해 지원되는 메서드 보냄 ex) Allow : GET, POST, PUT, OPTIONS | X |
    | DELETE | 서버에서 문서 제거 | X |
- 상태코드
    - 상태코드는 응답메세지의 시작줄에 들어간다
    
    | 전체 범위 | 분류 |
    | --- | --- |
    | 100~199 | 정보 |
    | 200~299 | 성공  |
    | 300~399 | 리다이렉션 : 리소스가 옮겨졌음을 의미 |
    | 400~499 | 클라이언트 에러 : 클라이언트에서 잘못된 요청을 했음을 의미 |
    | 500~599 | 서버 에러 : 서버에서 뭔가 실패했음을 의미 |
    - 상태 코드 - 100
    
    | 상태 코드 | 사유 구절 | 설명 |
    | --- | --- | --- |
    | 100 | Continue | 요청의 일부는 받았고, 클라이언트가 나머지 부분을 이어서 보내야 함 |
    | 101 | Switching Protocols | 클라이언트가 Upgrade 헤더에 나열한 것 중 하나로 서버가 프로토콜을 바꾸었음을 의미 |
    - 상태 코드 - 200
    
    | 상태 코드 | 사유 구절 | 설명 |
    | --- | --- | --- |
    | 200 | OK | 요청은 정상이고, 엔터티 본문은 요청된 리소스를 포함하고 있음 |
    | 201 | Created | 서버에 개체를 생성(POST, PUT등) 하기 위한 것으로 응답은 생성된 개체에 대한 정보를 담은 Location 헤더를 포함 |
    | 204 | No Content | 요청이 성공했지만 클라이언트가 현재 페이지에서 이동할 필요가 없음을 의미 |
    - 상태 코드 - 300 : 클라이언트가 관심있어하는 리소스에 대해 다른 위치를 사용하라고 알려주거나, 대신 사용할 리소스를 알려줌
    
    | 상태 코드 | 사유 구절 | 설명 |
    | --- | --- | --- |
    | 301 | Moved Parmanently | 요청한 URL이 옮겨졌을 때 사용, 응답은 Location 헤더에 현재 리소스가 존재하는 URL을 포함 |
    | 302 | Found | 301 상태 코드와 같지만 클라이언트는 Location 헤더로 주어진 URL의 리소스를 임시로 가리키기 위한 목적으로 사용해야 하고, 
    이후의 요청은 원래 URL을 사용한다 |
    | 304 | Not Modified | 요청이 성공했지만 클라이언트가 현재 페이지에서 이동할 필요가 없음을 의미 |
    | 305 | Use Proxy | 리소스가 반드시 프락시를 통해서 접근해야 함을 나타내기 위해 사용, 프락시 위치는 Location 헤더를 통해 주어짐 |
    - 상태 코드 - 400
    
    | 상태 코드 | 사유 구절 | 설명 |
    | --- | --- | --- |
    | 400 | Bad Request | 클라이언트가 잘못된 요청을 보냄 |
    | 401 | Unauthorized | 리소스를 얻기 전에 클라이언트 인증이 필요함 |
    | 403 | Forbidden | 요청이 서버에 의해 거부되었음을 알려주기 위해 사용,
    거절 이유를 응답 본문에 포함시킬 수 있지만 숨길 수도 있음 |
    | 404 | Not Found | 서버가 요청한 URL 을 찾을 수 없음 |
    | 405 | Method
     Not Allowed | 요청한 URL에 대해 지원하지 않는 메서드로 요청을 받았을 때 사용,
    응답으로 서버에서 사용 가능한 메서드 목록을 Allow헤더에 포함시킴 |
    - 상태코드 - 500
    
    | 상태 코드 | 사유 구절 | 설명 |
    | --- | --- | --- |
    | 500 | Internal Server Error | 서버가 요청을 처리할 수 없게 만든 에러가 발생한 경우 |
    | 501 | Not Implemented | 서버가 지원하지 않는 메서드를 사용한 것과 같은 
    서버에서 처리할 수 없는 요청인 경우 |
    | 502 | Bad Gateway | 프록시나 게이트웨이의 역할을 하는 서버로 부터 잘못된 응답을 받은 경우 |
    | 505 | HTTP Version Not Supported | 서버에서 지원하지 않는 프로토콜 버전을 사용한 경우 |
- 헤더 소개
    
    
    | 종류 | 설명 |
    | --- | --- |
    | 일반 헤더 | 요청과 응답 양쪽 모두에 나타낼 수 있음 |
    | 요청 헤더 | 요청에 대한 부가 정보 제공 |
    | 응답 헤더 | 응답에 대한 부가 정보 제공 |
    | 엔터티 헤더 | 본문 크기와 콘텐츠, 혹은 리소스 그 자체를 서술 |
    | 확장 헤더 | 명세에 정의되지 않은 새로운 헤더 |
    - 흔히 쓰이는 헤더의 예시
        
        
        |  |  |
        | --- | --- |
        |  |  |
        |  |  |